document.addEventListener("DOMContentLoaded", () => {

  /* ================= ELEMENT ================= */
  const globalSearch = document.getElementById("globalSearch");

  const filterCabang = document.getElementById("filterCabang");
  const filterPrincipal = document.getElementById("filterPrincipal");
  const filterPIC = document.getElementById("filterPIC");

  const cards = document.querySelectorAll(".analyst-card");
  const sidebarItems = document.querySelectorAll(
    "#sidebarMenu li, #mobileSidebarMenu li"
  );

  /* ================= FILTER FUNCTION ================= */
  function applyAllFilters() {
    const keyword = globalSearch.value.toLowerCase();
    const cabangValue = filterCabang.value.toLowerCase();
    const principalValue = filterPrincipal.value.toLowerCase();
    const picValue = filterPIC.value.toLowerCase();

    /* -------- JOBDESK -------- */
    cards.forEach(card => {
      const text = card.innerText.toLowerCase();
      const cabang = card.dataset.cabang.toLowerCase();
      const principal = card.dataset.principal.toLowerCase();
      const pic = card.id.toLowerCase();

      const matchSearch = keyword === "" || text.includes(keyword);
      const matchCabang = cabangValue === "" || cabang.includes(cabangValue);
      const matchPrincipal = principalValue === "" || principal.includes(principalValue);
      const matchPIC = picValue === "" || pic === picValue;

      card.style.display =
        matchSearch && matchCabang && matchPrincipal && matchPIC
          ? "block"
          : "none";
    });

    /* -------- SIDEBAR (Dokumen / OneDrive / Power BI) -------- */
    sidebarItems.forEach(item => {
      const text = item.innerText.toLowerCase();
      item.style.display =
        keyword === "" || text.includes(keyword)
          ? "block"
          : "none";
    });
  }

  /* ================= EVENTS ================= */
  globalSearch.addEventListener("keyup", applyAllFilters);
  filterCabang.addEventListener("change", applyAllFilters);
  filterPrincipal.addEventListener("change", applyAllFilters);
  filterPIC.addEventListener("change", applyAllFilters);

});
